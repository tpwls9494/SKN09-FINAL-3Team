<!-- ì˜¤ë¥¸ìª½ íŒ¨ë„: ìƒì„±ëœ íŠ¹í—ˆ ì´ˆì•ˆ -->
<div class="panel draft-panel">
  <div class="panel-header">
    <div class="panel-title">ìƒì„±ëœ íŠ¹í—ˆ ëª…ì„¸ì„œ ì´ˆì•ˆ</div>
  </div>
  <div class="panel-body">
    {% if draft %}
      <div id="draftContent" style="display: block;">
        <div class="markdown-content">
          {{ draft.create_draft|linebreaks }}
        </div>
        
        <!-- ì¼ë°˜ ëª¨ë“œ ë²„íŠ¼ -->
        <div class="button-row" id="normalButtons">
          <button type="button" class="btn btn-success" onclick="App.draft.save()">ì €ì¥</button>
          <button type="button" class="btn btn-warning" onclick="App.draft.enableEdit()">ì§ì ‘ ìˆ˜ì •</button>
          <button type="button" class="btn btn-info" onclick="App.draft.requestAI()">AI ìš”ì²­</button>
          <button type="button" class="btn btn-primary" onclick="App.evaluation.start()">AI í‰ê°€</button>
          <button type="button" class="btn btn-secondary" onclick="App.draft.download()">ë‹¤ìš´ë¡œë“œ</button>
          <a href="{% url 'assist:download_pdf' draft.draft_id %}" class="btn btn-info">PDF ë‹¤ìš´ë¡œë“œ</a>
          <a href="{% url 'assist:download_docx' draft.draft_id %}" class="btn btn-info">DOCX ë‹¤ìš´ë¡œë“œ</a>
        </div>
        
        <!-- ìˆ˜ì • ëª¨ë“œ ë²„íŠ¼ -->
        <div class="button-row edit-mode-buttons" id="editButtons" style="display: none;">
          <button type="button" class="btn btn-secondary" onclick="App.draft.cancelEdit()">ì·¨ì†Œ</button>
          <button type="button" class="btn btn-primary" onclick="App.draft.saveEdit()">ìˆ˜ì •</button>
        </div>
        
        <!-- ê¸°ì¡´ Draft ë‚´ìš©ì„ JavaScriptì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ìˆ¨ê²¨ì§„ ë°ì´í„° -->
        <script>
          if (typeof App !== 'undefined') {
            App.data.currentDraftContent = `{{ draft.create_draft|escapejs }}`;
            App.data.currentDraftId = {{ draft.draft_id }};
          }
        </script>
      </div>
    {% else %}
      <div class="no-draft-message" id="noDraftMessage">
        <p>í…œí”Œë¦¿ì„ ì‘ì„±í•˜ì—¬ íŠ¹í—ˆ ì´ˆì•ˆì„ ìƒì„±í•˜ì„¸ìš”.</p>
      </div>
      
      <div id="draftContent" style="display: none;">
        <!-- JavaScriptë¡œ ë™ì  ìƒì„±ë  ì˜ì—­ -->
        
        <!-- ì¼ë°˜ ëª¨ë“œ ë²„íŠ¼ -->
        <div class="button-row" id="normalButtons">
          <button type="button" class="btn btn-success" onclick="App.draft.save()">ì €ì¥</button>
          <button type="button" class="btn btn-warning" onclick="App.draft.enableEdit()">ì§ì ‘ ìˆ˜ì •</button>
          <button type="button" class="btn btn-info" onclick="App.draft.requestAI()">AI ìš”ì²­</button>
          <button type="button" class="btn btn-primary" onclick="App.evaluation.start()">AI í‰ê°€</button>
          <button type="button" class="btn btn-secondary" onclick="App.draft.download()">ë‹¤ìš´ë¡œë“œ</button>
        </div>
        
        <!-- ìˆ˜ì • ëª¨ë“œ ë²„íŠ¼ -->
        <div class="button-row edit-mode-buttons" id="editButtons" style="display: none;">
          <button type="button" class="btn btn-secondary" onclick="App.draft.cancelEdit()">ì·¨ì†Œ</button>
          <button type="button" class="btn btn-primary" onclick="App.draft.saveEdit()">ìˆ˜ì •</button>
        </div>
      </div>
    {% endif %}
    
    {% if feedback %}
      <div class="evaluation-feedback">
        <h4>AI í‰ê°€ ê²°ê³¼</h4>
        <p>{{ feedback }}</p>
      </div>
    {% endif %}
  </div>
</div>
<div class="modal-overlay" id="downloadModal" style="display: none;">
  <div class="modal-container">
    <div class="modal-header">
      <h3>íŒŒì¼ë‹¤ìš´ë¡œë“œ</h3>
      <button class="modal-close" onclick="App.download.closeModal()">Ã—</button>
    </div>
    
    <div class="modal-body">
      <p class="modal-description">ë‹¤ìš´ë¡œë“œí•  íŒŒì¼ í¬ë§·ì„ ì„ íƒí•˜ì„¸ìš”.</p>
      
      <div class="format-options">
        <label class="format-option">
          <input type="radio" name="fileFormat" value="docx" checked>
          <span class="format-icon">ğŸ“„</span>
          <span class="format-name">docx</span>
        </label>
        
        <label class="format-option">
          <input type="radio" name="fileFormat" value="pdf">
          <span class="format-icon">ğŸ“‹</span>
          <span class="format-name">pdf</span>
        </label>
        
        <label class="format-option">
          <input type="radio" name="fileFormat" value="hwp">
          <span class="format-icon">ğŸ“</span>
          <span class="format-name">hwp</span>
        </label>
      </div>
    </div>
    
    <div class="modal-footer">
      <button class="btn btn-secondary" onclick="App.download.closeModal()">ì·¨ì†Œ</button>
      <button class="btn btn-primary" onclick="App.download.confirmDownload()">ì €ì¥</button>
    </div>
  </div>
</div>